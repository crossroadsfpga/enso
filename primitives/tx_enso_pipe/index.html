
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Ensō is a fast and flexible streaming interface for NIC-application communication.">
      
      
        <meta name="author" content="Hugo Sadok">
      
      
        <link rel="canonical" href="https://enso.cs.cmu.edu/primitives/tx_enso_pipe/">
      
      
        <link rel="prev" href="../rx_enso_pipe/">
      
      
        <link rel="next" href="../rx_tx_enso_pipe/">
      
      <link rel="icon" href="../../assets/enso-black.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.0.14">
    
    
      
        <title>TX Ensō Pipe - Ensō</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.113286f1.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-7WKNV89H63"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-7WKNV89H63",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-7WKNV89H63",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tx-enso-pipe" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Ensō" class="md-header__button md-logo" aria-label="Ensō" data-md-component="logo">
      
  <img src="../../assets/enso-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ensō
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              TX Ensō Pipe
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black"  aria-hidden="true"  type="radio" name="__palette" id="__palette_1">
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/crossroadsfpga/enso" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    crossroadsfpga/enso
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../getting_started/" class="md-tabs__link">
        Getting Started
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../rx_enso_pipe/" class="md-tabs__link md-tabs__link--active">
        Primitives
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../hardware/counters/" class="md-tabs__link">
        Hardware Reference
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="/software/" target="_blank" class="md-tabs__link">
      Software Reference
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Ensō" class="md-nav__button md-logo" aria-label="Ensō" data-md-component="logo">
      
  <img src="../../assets/enso-white.svg" alt="logo">

    </a>
    Ensō
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/crossroadsfpga/enso" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    crossroadsfpga/enso
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/" class="md-nav__link">
        System Requirements
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../compiling_software/" class="md-nav__link">
        Compiling Software
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../compiling_hardware/" class="md-nav__link">
        Compiling Hardware
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../enso_cli/" class="md-nav__link">
        Ensō CLI Tool
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../running/" class="md-nav__link">
        Running
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ensogen/" class="md-nav__link">
        EnsōGen
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Primitives
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Primitives
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rx_enso_pipe/" class="md-nav__link">
        RX Ensō Pipe
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          TX Ensō Pipe
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        TX Ensō Pipe
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#allocating-a-tx-enso-pipe" class="md-nav__link">
    Allocating a TX Ensō Pipe
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#allocating-a-buffer" class="md-nav__link">
    Allocating a buffer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transmitting-data" class="md-nav__link">
    Transmitting data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#partial-transfers" class="md-nav__link">
    Partial transfers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extending-a-buffer" class="md-nav__link">
    Extending a buffer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    Summary
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rx_tx_enso_pipe/" class="md-nav__link">
        RX/TX Ensō Pipe
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../device/" class="md-nav__link">
        Device
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Hardware Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Hardware Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/counters/" class="md-nav__link">
        Hardware Counters
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
          Hardware Modules
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Hardware Modules
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/modules/basic_data_mover/" class="md-nav__link">
        Entity: basic_data_mover
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/modules/configurator/" class="md-nav__link">
        Entity: configurator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/modules/dc_back_pressure/" class="md-nav__link">
        Entity: dc_back_pressure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/modules/esram_wrapper/" class="md-nav__link">
        Entity: esram_wrapper
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/modules/flow_director/" class="md-nav__link">
        Entity: flow_director
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/modules/flow_table_wrapper/" class="md-nav__link">
        Entity: flow_table_wrapper
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/modules/hash_func/" class="md-nav__link">
        Entity: hash_func
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/modules/hyper_pipe/" class="md-nav__link">
        Entity: hyper_pipe
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/modules/hyper_pipe_root/" class="md-nav__link">
        Entity: hyper_pipe_root
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/modules/hyper_pipe_rst/" class="md-nav__link">
        Entity: hyper_pipe_rst
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/modules/input_comp/" class="md-nav__link">
        Entity: input_comp
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/modules/my_stats/" class="md-nav__link">
        Entity: my_stats
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/modules/parser/" class="md-nav__link">
        Entity: parser
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/modules/pdu_gen/" class="md-nav__link">
        Entity: pdu_gen
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/modules/rate_limiter/" class="md-nav__link">
        Entity: rate_limiter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/modules/timestamp/" class="md-nav__link">
        Entity: timestamp
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/modules/top/" class="md-nav__link">
        Entity: top
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2_18" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_2_18" id="__nav_4_2_18_label" tabindex="0">
          Pcie
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_2_18_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_2_18">
          <span class="md-nav__icon md-icon"></span>
          Pcie
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/modules/pcie/bram_mux/" class="md-nav__link">
        Entity: bram_mux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/modules/pcie/cpu_to_fpga/" class="md-nav__link">
        Entity: cpu_to_fpga
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/modules/pcie/fpga_to_cpu/" class="md-nav__link">
        Entity: fpga_to_cpu
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/modules/pcie/jtag_mmio_arbiter/" class="md-nav__link">
        Entity: jtag_mmio_arbiter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/modules/pcie/pcie_core/" class="md-nav__link">
        Entity: pcie_core
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/modules/pcie/pcie_top/" class="md-nav__link">
        Entity: pcie_top
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/modules/pcie/queue_manager/" class="md-nav__link">
        Entity: queue_manager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hardware/modules/pcie/rx_dsc_queue_manager/" class="md-nav__link">
        Entity: rx_dsc_queue_manager
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/software/" target="_blank" class="md-nav__link">
        Software Reference
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#allocating-a-tx-enso-pipe" class="md-nav__link">
    Allocating a TX Ensō Pipe
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#allocating-a-buffer" class="md-nav__link">
    Allocating a buffer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transmitting-data" class="md-nav__link">
    Transmitting data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#partial-transfers" class="md-nav__link">
    Partial transfers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extending-a-buffer" class="md-nav__link">
    Extending a buffer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    Summary
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/crossroadsfpga/enso/edit/master/docs/primitives/tx_enso_pipe.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/crossroadsfpga/enso/raw/master/docs/primitives/tx_enso_pipe.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg>
    </a>
  


<h1 id="tx-enso-pipe">TX Ensō Pipe</h1>
<p>TX Ensō Pipes work in reverse to <a href="../rx_enso_pipe/">RX Ensō Pipes</a> and are used to <em>transmit</em> data to the NIC. To send data through a TX Ensō Pipe, the application allocates a buffer within the pipe, fill it with data and then send it.</p>
<h2 id="allocating-a-tx-enso-pipe">Allocating a TX Ensō Pipe</h2>
<p>You need to use a <a href="../device/">Device</a> object to allocate a TX Ensō Pipe. For example:</p>
<div class="highlight"><pre><span></span><code><span class="n">enso</span><span class="o">::</span><span class="n">TxPipe</span><span class="o">*</span><span class="w"> </span><span class="n">tx_pipe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">device</span><span class="o">-&gt;</span><span class="n">AllocateTxPipe</span><span class="p">();</span>
<span class="n">assert</span><span class="p">(</span><span class="n">tx_pipe</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">);</span>
</code></pre></div>
<p>Note that pipes are not thread safe. Each thread that receives data in a program should allocate its own device instance and TX Ensō Pipes.</p>
<h2 id="allocating-a-buffer">Allocating a buffer</h2>
<p>TX Ensō Pipes manage memory through a simple best-effort allocator. The allocator will always try to return the largest contiguous buffer possible within a given TX Ensō Pipe. The allocated buffer's capacity can also implicitly <em>increase</em> at any point but it will never implicitly <em>decrease</em>.</p>
<p>To request a buffer, the application calls <a href="/software/classenso_1_1TxPipe.html#a45762501055df470f8c6bb2d747e8228" target="_blank"><code>TxPipe::AllocateBuf()</code></a> with a target size. This will return a buffer with size at least as large as the target. Each pipe can only allocate a single buffer at a time. If the application calls <code>TxPipe::AllocateBuf()</code> while a buffer is still valid, the function will return the same buffer. Since the buffer's capacity can implicitly increase, the application can always retrieve the current capacity by calling <a href="/software/classenso_1_1TxPipe.html#a657f7225e695b20cc71136747e276952" target="_blank"><code>TxPipe::capacity()</code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The application should never call <code>TxPipe::AllocateBuf()</code> with a target larger than the TX Ensō Pipe's overall capacity (<a href="/software/classenso_1_1TxPipe.html#a32c0c96558b1688da50db2e734130e44" target="_blank"><code>TxPipe::kMaxCapacity</code></a>). Doing so would cause the function to block indefinitely.</p>
</div>
<h2 id="transmitting-data">Transmitting data</h2>
<p>Once ready to send data, the application calls <a href="/software/classenso_1_1TxPipe.html#a4f61c0c8b42904c58459dcde6e51ae0d" target="_blank"><code>TxPipe::SendAndFree()</code></a>, specifying the amount of data to be sent. This will send the data and free the buffer.</p>
<p>Here is an example of how to use a <code>TxPipe</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">enso</span><span class="o">::</span><span class="n">TxPipe</span><span class="o">*</span><span class="w"> </span><span class="n">tx_pipe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">device</span><span class="o">-&gt;</span><span class="n">AllocateTxPipe</span><span class="p">();</span><span class="w"> </span><span class="c1">// (1)!</span>
<span class="n">assert</span><span class="p">(</span><span class="n">tx_pipe</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">);</span>

<span class="c1">// Allocate a buffer.</span>
<span class="kt">uint8_t</span><span class="o">*</span><span class="w"> </span><span class="n">buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tx_pipe</span><span class="o">-&gt;</span><span class="n">AllocateBuf</span><span class="p">(</span><span class="n">data_size</span><span class="p">);</span>

<span class="c1">// Fill the buffer with data.</span>
<span class="c1">// [...]</span>

<span class="c1">// Send the data.</span>
<span class="n">tx_pipe</span><span class="o">-&gt;</span><span class="n">SendAndFree</span><span class="p">(</span><span class="n">data_size</span><span class="p">);</span>

<span class="c1">// The previous buffer is now invalid, allocate a new one.</span>
<span class="n">buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tx_pipe</span><span class="p">.</span><span class="n">AllocateBuf</span><span class="p">(</span><span class="n">data_size2</span><span class="p">);</span>
</code></pre></div>
<ol>
<li><img alt="ℹ" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2139.svg" title=":information_source:" /> Note that you should use a <a href="../device/">Device</a> instance to allocate a TX Ensō Pipe.</li>
</ol>
<p>In the previous example, we knew the amount of data to be transmitted and we explicitly specified it as the target when calling <code>TxPipe::AllocateBuf()</code>. This works well for smaller transfers or when we know the pipe's capacity is large enough to hold the data. However, if the target is too large, it will cause <code>TxPipe::AllocateBuf()</code> to block waiting for enough free space in the TX Ensō Pipe. To avoid this, one may use the TxPipe in a different way. Instead of explicitly setting a target size when allocating the buffer, we can let the pipe dictate how much data that can be sent at a given time. For example:</p>
<div class="highlight"><pre><span></span><code><span class="n">enso</span><span class="o">::</span><span class="n">TxPipe</span><span class="o">*</span><span class="w"> </span><span class="n">tx_pipe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">device</span><span class="o">-&gt;</span><span class="n">AllocateTxPipe</span><span class="p">();</span>
<span class="n">assert</span><span class="p">(</span><span class="n">tx_pipe</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">);</span>

<span class="c1">// Allocate a buffer. Note that we do not specify a target size.</span>
<span class="c1">// This makes sure that AllocateBuf will never block.</span>
<span class="kt">uint8_t</span><span class="o">*</span><span class="w"> </span><span class="n">buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tx_pipe</span><span class="o">-&gt;</span><span class="n">AllocateBuf</span><span class="p">();</span>

<span class="c1">// Retrieve the buffer&#39;s current capacity.</span>
<span class="kt">uint32_t</span><span class="w"> </span><span class="n">data_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tx_pipe</span><span class="o">-&gt;</span><span class="n">capacity</span><span class="p">();</span>

<span class="c1">// Fill the buffer with data, up to the buffer&#39;s capacity.</span>
<span class="c1">// [...]</span>

<span class="c1">// Send the data.</span>
<span class="n">tx_pipe</span><span class="o">-&gt;</span><span class="n">SendAndFree</span><span class="p">(</span><span class="n">data_size</span><span class="p">);</span>

<span class="c1">// The previous buffer is now invalid, allocate a new one.</span>
<span class="n">buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tx_pipe</span><span class="p">.</span><span class="n">AllocateBuf</span><span class="p">();</span>
</code></pre></div>
<h2 id="partial-transfers">Partial transfers</h2>
<p>So far we have always transmitted the entire allocated buffer. However, sometimes it is useful to send only a portion of the buffer. This can be easily achieved by calling <code>TxPipe::SendAndFree()</code> with a size smaller than the buffer's capacity. The function will send the specified amount of data, starting from the beginning of the buffer, ignoring all data after the specified size.</p>
<p>Things get more interesting when the part of the buffer that was not sent needs to be used in a subsequent transfer. For instance, the buffer may contain an incomplete message that should be completed before it is sent in the next transfer. In this case, the application can rely on the fact that the data that was not sent will be available in the next buffer allocated using <code>TxPipe::AllocateBuf()</code>.</p>
<p>The following diagram illustrates this behavior. At step ①, the application allocates Buffer 1 using <code>TxPipe::AllocateBuf()</code>. At step ②, the application partially fills the buffer with data but sends only a portion of it using <code>TxPipe::SendAndFree()</code>. At step ③, the application allocates Buffer 2 using <code>TxPipe::AllocateBuf()</code>. The new buffer starts with the unsent data from the previous buffer.</p>
<figure>
<p><img alt="TX Ensō Pipe partial transfer" src="/assets/tx_pipe_partial_sent.svg" width="550" />
  </p>
<figcaption>Example of a partial transfer. The unsent data is available in the next buffer returned by TxPipe::AllocateBuf().</figcaption>
</figure>
<h2 id="extending-a-buffer">Extending a buffer</h2>
<p>Since the buffer size can implicitly increase at any point, the application can fetch the current buffer's capacity by calling <code>TxPipe::capacity()</code>. The application can also explicitly request a buffer extension by calling <a href="/software/classenso_1_1TxPipe.html#a8653a12e93e8899f831945d598940f2c" target="_blank"><code>TxPipe::TryExtendBuf()</code></a> or <a href="/software/classenso_1_1TxPipe.html#a07595636f9a03cb356d30fd7cd31e319" target="_blank"><code>TxPipe::ExtendBufToTarget()</code></a>. When calling <code>TxPipe::TryExtendBuf()</code>, the TX Ensō Pipe allocator will check for completions to try to extend the allocated buffer's capacity but it will not block. When calling <code>TxPipe::ExtendBufToTarget()</code>, the TX Ensō Pipe allocator will block until the requested capacity is available.</p>
<p>Note that the previous buffer is not invalidated after calling <code>TxPipe::TryExtendBuf()</code> or <code>TxPipe::ExtendBufToTarget()</code>. Buffers only become invalid after calling <code>TxPipe::SendAndFree()</code>.</p>
<h2 id="examples">Examples</h2>
<p>The following examples use TX Ensō Pipes:</p>
<ul>
<li><a href="https://github.com/crossroadsfpga/enso/blob/master/software/examples/echo_copy.cpp" target="_blank"><code>echo_copy.cpp</code></a></li>
</ul>
<h2 id="summary">Summary</h2>
<ul>
<li><code>TxPipe::AllocateBuf()</code> will return the maximum contiguous buffer possible for a given TX Ensō Pipe.</li>
<li>Applications can use <code>TxPipe::AllocateBuf()</code> to allocate a buffer of a minimum target size or they can use <code>TxPipe::AllocateBuf(0)</code> to avoid blocking.</li>
<li>The allocated buffer's capacity can be retrieved by calling <code>TxPipe::capacity()</code>.</li>
<li>The allocated buffer's capacity can implicitly <em>increase</em> at any point but it will never implicitly <em>decrease</em>.</li>
<li>If needed, the application can request a buffer extension by calling <code>TxPipe::TryExtendBuf()</code> or <code>TxPipe::ExtendBufToTarget()</code>.</li>
<li>The buffer returned by <code>TxPipe::AllocateBuf()</code> is valid until we call <code>TxPipe::SendAndFree()</code>. Even explicit extensions do not invalidate the buffer.</li>
<li>After calling <code>TxPipe::SendAndFree()</code>, the application should call <code>TxPipe::AllocateBuf()</code> again to get a new buffer.</li>
<li>If the buffer was only partially sent, the new allocated buffer will start with the remaining data.</li>
<li>The application should not try to modify data from a sent buffer, doing so will result in undefined behavior.</li>
</ul>


  




                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../rx_enso_pipe/" class="md-footer__link md-footer__link--prev" aria-label="Previous: RX Ensō Pipe" rel="prev">
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <div class="md-ellipsis">
                <span class="md-footer__direction">
                  Previous
                </span>
                RX Ensō Pipe
              </div>
            </div>
          </a>
        
        
          
          <a href="../rx_tx_enso_pipe/" class="md-footer__link md-footer__link--next" aria-label="Next: RX/TX Ensō Pipe" rel="next">
            <div class="md-footer__title">
              <div class="md-ellipsis">
                <span class="md-footer__direction">
                  Next
                </span>
                RX/TX Ensō Pipe
              </div>
            </div>
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 <a href=https://hsadok.com target="_blank">Hugo Sadok</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.2a6f1dda.min.js"></script>
      
        <script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
      
        <script src="../../javascripts/tablesort.js"></script>
      
    
  </body>
</html>